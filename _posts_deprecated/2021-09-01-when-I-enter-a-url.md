---
title: 인터넷 브라우저에 www.naver.com을 검색했을 때 화면이 띄워지기까지
author: Banny
date: 2021-09-01 11:39:00 +0900
categories: [Network]
tags: [Network]
---

인터넷 브라우저에 www.naver.com을 검색했을 때, 화면이 띄워지기까지의 과정은 다음과 같습니다.

## 1. 브라우저가 url을 해석합니다.

- https://www.naver.com을 입력했을 때, 어떤 ‘프로토콜’을 통해 요청할 것인지, 어떤 ‘url’로 요청할 것인지, 어떤 ‘포트’로 요청할 것인지, 브라우저에서 각각 프로토콜, url, 포트를 해석하여 분석합니다.
- 포트를 명시하지 않았다면 http는 80을, https는 443 포트를 요청하게 됩니다.

## 2. HSTS 목록 조회 (Http Strict Transport Security)

- 해당 url이 HSTS 목록에 있으면 첫 요청을 https로 보내고, 아니면 http로 보냅니다.<br>
  *HSTS: https만을 사용해야 한다고 웹사이트가 웹브라우저에게 알리는 보안 기능.<br>
  *HSTS 목록에는 https로만 연결되도록 요청한 웹사이트의 목록이 존재합니다.

## 3. DNS를 통해 url을 ip주소로 변환

- url로는 통신을 할 수 없기 때문에, 해당 url의 ip주소를 얻어야 합니다.
- 먼저 브라우저에서는 자신의 로컬 호스트 파일과 브라우저 캐시에 해당 url이 있는지 확인합니다.
- 존재하지 않으면 도메인 주소를 ip주소로 변환해주는 DNS 서버에 요청하여 해당 ip주소를 전달 받습니다.

## 4. 라우터를 통해 해당 서버의 게이트웨이까지 이동

- ip주소를 얻었으니, 해당 서버로 요청을 보냅니다.
- 라우터는 해당 요청이 어떤 경로를 통해 가야할 지 경로를 지정해줍니다.

## 5. ARP(Address Resolution Protocol, 주소 결정 프로토콜)를 통해 ip주소를 mac주소로 변환

- 실질적 통신을 위해 ip주소를 컴퓨터의 고유 주소인 mac주소로 변환해야 합니다.
- 이를 위해 해당 네트워크 내에서 ARP를 브로드 캐스팅합니다.
- 브로드캐스트를 하는 이유는, 목적지의 물리주소를 모르기 때문에 모두에게 요청해야하기 때문입니다.
- 모든 호스트와 라우터는 송신자가 보낸 ARP 요청 패킷을 수신합니다.
- 해당되는 수신자만 자신의 ip주소와 mac주소가 담긴 응답 패킷을 전송합니다.
- 목적지의 mac주소를 얻었습니다.

## 6. 대상 서버와 TCP 소켓 연결

- 이 과정은 TCP/IP three-way handshake 과정을 통해 이루어집니다.<br>
  a. 서버가 열려있는지 물어보며 서버에 SYN 패킷을 보냅니다.<br>
  b. 서버가 연결을 시작할 수 있는 포트를 가지고 있다면, 서버는 SYN 패킷의 ACKnowledgement로 응답합니다.<br>
  c. 클라이언트가 SYN/ACK 패킷을 받고, 서버에 ACK 패킷을 보냄으로써 받았음을 알려줍니다.<br>
- 위 과정을 통해 TCP 통신이 이루어집니다.

## 7. 브라우저는 웹 서버에 http 요청을 보냅니다.

- url에 요청을 보내는 것이기 때문에 GET 요청을 보냅니다.

## 8. 요청을 받은 서버는 응답 메시지와 함께 응답을 내보냅니다.

## 9. 브라우저는 응답을 받은 HTML 컨텐츠를 표시합니다.

- 먼저 html을 렌더하고,
- html 태그를 확인하면서 css stylesheet, javascript 파일과 같은 추가적인 요소에 대한 get 요청을 보냅니다.
- static file(js, css, image)은 브라우저에 의해 캐시되기 때문에, 다음에 동일한 페이지를 방문했을 때 그것들을 다시 요청할 필요가 없습니다.

<br>
<br>
